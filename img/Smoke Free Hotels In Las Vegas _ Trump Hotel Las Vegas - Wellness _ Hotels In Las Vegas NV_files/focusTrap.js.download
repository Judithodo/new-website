;(function($,window,document,undefined){"use strict";let pluginName="focusTrap",defaults={modalSelector:'#nothing',modalClose:'.bnothing-close',modalCloseMobile:'.nothing-trigger',focusedElementBeforeModal:'',focusModal:false,};let modal;let modalOpen=false;let firstElement;let escClose=false;const focusableElementsString="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable], .focus-it";const mq=window.matchMedia("(min-width: 1025px)");function Plugin(element,options){this.element=element;this.$element=$(element);this.settings=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init();}
Plugin.prototype={reInit:function(name){console.log('reinit Prototype B',name);modalOpen=true;firstElement=$(name);}}
$.extend(Plugin.prototype,{init:function(){modal=document.querySelector(this.settings.modalSelector)
$('.focus-trap').each(function(){$(this).removeClass('focus-trap')})
$(modal).show().addClass('focus-trap');if(modal){modalOpen=true;this.captureTriggerFocus();this.trapFocusInModal();this.setClose();this.setInitFocus();}else{console.error('Oopsy');}},captureTriggerFocus:function(){this.focusedElementBeforeModal=jQuery(':focus');},trapFocusInModal:function(){document.addEventListener("focus",function(event){if(modalOpen&&!modal.contains(event.target)){event.stopPropagation();if(this.focusModal!==true){firstElement.focus();}else{modal.focus();}}},true);},setClose:function(){let el=this;let modSel=this.settings.modalSelector;modal.addEventListener("keydown",function(event){if(event.keyCode==27){console.log(modal,el);}
if(modalOpen&&event.keyCode==27){escClose=true;$(el.settings.modalClose).trigger('click');el.setCloseFocus();}},true);$(this.settings.modalClose).on('click.closeClick',function(e){if(!escClose){el.setCloseFocus();}else{escClose=false;el.setCloseFocus();}});},setCloseFocus:function(){$(modal).hide();if(this.focusedElementBeforeModal.length===0){let focusable=document.querySelectorAll(focusableElementsString);let focusableAll=$('*');let firstFocusable=focusableAll.filter(focusableElementsString).filter('[tabindex=1]').first();if(firstFocusable.length===0){firstFocusable=focusable[0];}
this.focusedElementBeforeModal=$(firstFocusable);}
this.focusedElementBeforeModal.focus().addClass('reinit');this.destroy();},setInitFocus:function(){let o=$(modal).find('*');let focusableItems;firstElement=o.filter(focusableElementsString).filter(':visible').first();if(this.focusModal!==true)
firstElement.focus();else
modal.focus();},destroy:function(){console.log('destroy function',this.$element);modalOpen=false;this.$element.removeData();this.$element.unbind();$(this.settings.modalClose).unbind('click.closeClick');}});$.fn[pluginName]=function(options){var args=Array.prototype.slice.call(arguments,1);return this.each(function(){if(!$.data(this,'plugin_'+pluginName)){$.data(this,'plugin_'+pluginName,new Plugin(this,options));}
else if($.isFunction(Plugin.prototype[options])){var instance=$.data(this,'plugin_'+pluginName)
instance[options].apply(instance,args);}else{$.data(this,'plugin_'+pluginName,new Plugin(this,options));}});};})(jQuery,window,document);$(document).ready(function(){$('.trumpcardmenu-trigger').click(function(e){e.preventDefault();console.log('TC Flyout clicked');$('#trumpcard-modal').focusTrap({propertyName:"a custom value",modalSelector:'#trumpcard-modal',modalClose:'.trumpcardmenu-content-close',modalCloseMobile:'.trumpcardmenu-trigger',});});$('.ourhotelsmenu-trigger').click(function(e){e.preventDefault();console.log('Our Hotels clicked');$('#ourhotels').focusTrap({modalSelector:'#ourhotels',modalClose:'#ourhotelsmenu-close',focusModal:false});});const mq=window.matchMedia("(min-width: 1025px)");$('#ourhotelsmenu-trigger').focus(function(e){if(!mq.matches&&$(this).hasClass('reinit')){$('.primary-nav').focusTrap({modalSelector:'.primary-nav',modalClose:'.nav-trigger',focusModal:false});}})
$('.nav-trigger').click(function(e){e.preventDefault();console.log('nav trigger clicked');$('.primary-nav').focusTrap({modalSelector:'.primary-nav',modalClose:'.nav-trigger',focusModal:false});});});